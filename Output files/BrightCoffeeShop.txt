SELECT *
FROM BRIGHT.COFFEE.SHOP

----------------------------------------------------------------------------------------
--Exploratory data analysis
--Number of coffee shops and their location
SELECT DISTINCT STORE_LOCATION, 
FROM BRIGHT.COFFEE.SHOP

--Product type and category
SELECT DISTINCT PRODUCT_CATEGORY,PRODUCT_TYPE
FROM BRIGHT.COFFEE.SHOP
ORDER BY PRODUCT_CATEGORY;

--Earliest time
SELECT MIN(TRANSACTION_TIME) AS Earliest_time
FROM BRIGHT.COFFEE.SHOP

--Latest time
SELECT MAX(TRANSACTION_TIME) AS Lastest_time
FROM BRIGHT.COFFEE.SHOP

--Total revenue per store location
SELECT STORE_LOCATION,SUM(TRANSACTION_QTY * UNIT_PRICE) AS TOTAL_REVENUE
FROM BRIGHT.COFFEE.SHOP
GROUP BY STORE_LOCATION;

-- Average Revenue per Sale:
SELECT SUM(TRANSACTION_QTY * UNIT_PRICE) / COUNT(DISTINCT TRANSACTION_ID) AS AVG_REVENUE_PER_SALE
FROM BRIGHT.COFFEE.SHOP

-- Average Quantity per Sale:
SELECT SUM(TRANSACTION_QTY) / COUNT(DISTINCT TRANSACTION_ID) AS AVG_QTY_PER_SALE
FROM BRIGHT.COFFEE.SHOP
-------------------------------------------------------------------------------------


SELECT TRANSACTION_DATE,
DAYNAME(TRANSACTION_DATE)AS DAY_NAME,
CASE 
    WHEN DAY_NAME IN('Sat','Sun') THEN 'Weekend'
    ELSE 'Weekday'
    END AS day_classification,
    MONTHNAME(TRANSACTION_DATE)AS MONTH_NAME,
--Transaction time
CASE
  WHEN HOUR(transaction_time) BETWEEN 6 AND 11 THEN 'Morning'
  WHEN HOUR(transaction_time) BETWEEN 12 AND 16 THEN 'Afternoon'
  WHEN HOUR(transaction_time) BETWEEN 17 AND 20 THEN 'Evening'
  ELSE 'Late Night'
END AS time_bucket,
HOUR(TRANSACTION_TIME)AS HOUR_OF_DAY,STORE_LOCATION,PRODUCT_CATEGORY,PRODUCT_DETAIL,PRODUCT_TYPE,
COUNT(DISTINCT TRANSACTION_ID)AS NUM_OF_SALES,
SUM(TRANSACTION_QTY * UNIT_PRICE) AS REVENUE
FROM BRIGHT.COFFEE.SHOP
GROUP BY ALL;